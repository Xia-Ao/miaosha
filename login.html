<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <title>opt请求</title>
    <link rel="stylesheet" type="text/css" href="static/assets/global/plugins/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="static/assets/global/css/components.css">
    <link rel="stylesheet" type="text/css" href="static/assets/admin/pages/css/login.css">

    <script src="./static/assets/global/plugins/jquery-1.11.0.min.js" type="text/javascript"></script>
</head>

<body>
<div class="login">
    <div class="content">
        <h3 class="form-title">用户登录</h3>
        <div class="form-group">
            <label class="control-label">手机号</label>
            <div>
                <input id="telephone" type="text" class="form-control" placeholder="手机号">
            </div>
            <label class="control-label">密码</label>
            <div>
                <input id="password" type="text" class="form-control" placeholder="密码">
            </div>
        </div>
        <div class="form-actions">
            <button id="loginBtn" class="btn blue" type="submit">登录</button>
            <button id="registerBtn" class="btn green" type="submit">注册</button>
        </div>
    </div>
</div>


<script>
    jQuery(document).ready(function () {
        $('#registerBtn').on('click', function () {
            window.location.href = 'register.html';
        })
        $('#loginBtn').on('click', function () {
            let telephone = $('#telephone').val();
            let password = $('#password').val();
            if (!telephone) {
                alert('手机号为空，请重新输入！')
            } else if (!password) {
                alert('密码不能为空，请重新输入！')
            } else {
                $.ajax({
                    type: 'POST',
                    contentType: 'application/x-www-form-urlencoded',
                    url: 'http://localhost:8090/user/login',
                    xhrFields: {withCredentials: true},
                    data: {
                        telephone: telephone,
                        password: password
                    },
                    success: function (data) {
                        if (data.status === 'success') {
                            alert('登录成功!');
                            window.location.href = 'list.html';
                        } else {
                            alert('登录失败：' + data.data.errMsg)
                        }
                    },
                    error: function (data) {
                        alert('请求出错' + data);
                    }
                })
            }

        })
    })
</script>
</body>

</html>